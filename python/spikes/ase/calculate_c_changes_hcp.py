import numpy as np
from numpy.polynomial.polynomial import polyfit
import matplotlib.pyplot as plt
import math

x = [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
gn = [2.772589, 3.218876, 3.583519, 3.891820, 4.158883, 4.394449, 4.605170, 4.795791, 4.969813, 5.129899, 5.278115, 5.416100, 5.545177, 5.666427]

# m = 3.4 * n * n * N
"""
hn = [0.671521, 1.088659, 1.504189, 1.509163, 1.935196, 2.147992, 2.683553, 2.885729, 3.147572, 3.308561, 3.270840, 3.431944, 3.674295, 3.737422]
h1 = [0.000000, 0.002623, 0.001904, 0.000000, 0.000000, 0.000928, 0.000000, 0.000000, 0.000000, 0.001441, 0.000841, 0.000371, 0.001322, 0.001184]
"""
# m = n * n * N
"""
hn = [0.681959, 1.083765, 1.484341, 1.515710, 1.923200, 2.130017, 2.680858, 2.883819, 3.134245, 3.320725, 3.287065, 3.415805, 3.684789, 3.739381]
h1 = [0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.002736, 0.004549, 0.003847, 0.000000, 0.000000, 0.005024, 0.001111, 0.000991, 0.003556]
"""
# m = 3.4 * n * N
"""
hn = [0.687250, 1.063382, 1.485489, 1.406996, 1.889981, 2.125918, 2.686530, 2.859451, 3.187602, 3.313669, 3.258852, 3.402782, 3.641759, 3.716940]
h1 = [0.000000, 0.000000, 0.000000, 0.000000, 0.014066, 0.012717, 0.011617, 0.010703, 0.004965, 0.004633, 0.030418, 0.020467, 0.015482, 0.022031]
"""

c = 2

"""
1)
h1/hn = 3.270840 + c * 0.00025712

3)
h1/hn = 3.258852 + c * 0.010438645
"""

y = []
#"""
i = 0
for n in x:
	H1nDiv = 0.0
	if hn[i] > 0:
		H1nDiv = (h1[i] / hn[i])

	H_n_extrapolated = hn[i] + (c * H1nDiv)
	hcn = H_n_extrapolated - gn[i]
	#hcn = hn[i] - gn[i]

	y.append(hcn)
	i += 1
#"""

x = np.asarray(x)
y = np.asarray(y)

# Fit with polyfit
b, m = polyfit(x[6:], y[6:], 1)

print("Entropia %f" % m)

font = {'weight': 'bold',
        'size': 12}

plt.rc('font', **font)

fig = plt.figure()
ax = fig.add_subplot(111)

axis_font = {'weight': 'bold', 'size':12}

ax.set_xlabel('n', **axis_font)
#ax.set_ylabel('H(n) - g(n)', **axis_font)
ax.set_ylabel('H(n)', **axis_font)

#ax.plot(x, y, '+')
ax.plot(x, y)
ax.plot(x, b + m * x, '--')
ax.axis([0, 20, -5, 5])

plt.show()
